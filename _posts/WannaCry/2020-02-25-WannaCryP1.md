---
title: "WannaCry P1 - detection & analyse in memeory "
classes: wide
header:
  teaser: /assets/images/WannaCry/p1/logo.gif
ribbon: red
description: "WannaCry was the world monster in 2017 , i will post 2 or 3 parts of my approach on detecting this malware in memory and using the iocs to creat a plugin to auto detect and finding the encryption keys if possible  "
categories:
  - Memory Forensics
  - DFIR 
toc: true
---
Hello all , welcome to first part of wannacry detection , analysis and protection

**WannaCry** is a ransomware that started his attacks in 2017 targeting Microsoft windows machines and caost the world alot  of money .  

after 4 years i decided to do a full analysis to this malware to sharpen my forensics and malware analysis skills  

the malware main attack is encrypting data , but there is another attack i didn't cover in my analysis because it targets the SMB in some windows server so it can spread through the network , to do this attack it used an exploit called **eternalblue** , also the domain that the malware use to download the executable that do this attack did not respond

# Lab Setup 
i used windows7 on vmware to run the malware sample , and allwaed it to comunicat over network without using a fakedns or fakenet , then i suspended the vim after 3 minuts of excution .

hero **Volatility** for analysing the memory .

sample hash : 84c82835a5d21bbcf75a61706d8ab549

if you want to try your self you can set up your lab or 
you can skip the setup part and use my memory_dump .
>>>>>>>>>>>>>>>>>>>>>>>> adddddddddddddddddddddddddddddddddddddddddd thhhhhhhhhhhhhhhhhhhhheee link when the upload finsh .........
dump md5 hash : 8ab0198a80acf83780a47a5f3882eb03



